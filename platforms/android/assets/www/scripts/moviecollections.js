(function($,document){var data={};function getPageData(){var key=getSavedQueryKey();var pageData=data[key];if(!pageData){pageData=data[key]={query:{SortBy:"SortName",SortOrder:"Ascending",IncludeItemTypes:"BoxSet",Recursive:true,Fields:"PrimaryImageAspectRatio,SortName,SyncInfo,CanDelete",ImageTypeLimit:1,EnableImageTypes:"Primary,Backdrop,Banner,Thumb",StartIndex:0,Limit:LibraryBrowser.getDefaultPageSize()},view:LibraryBrowser.getSavedView(key)||LibraryBrowser.getDefaultItemsView('Poster','Poster')};LibraryBrowser.loadSavedQueryValues(key,pageData.query);}
return pageData;}
function getQuery(){return getPageData().query;}
function getSavedQueryKey(){return getWindowUrl();}
function reloadItems(page){Dashboard.showLoadingMsg();var query=getQuery();var promise1=ApiClient.getItems(Dashboard.getCurrentUserId(),query);var promise2=Dashboard.getCurrentUser();$.when(promise1,promise2).done(function(response1,response2){var result=response1[0];var user=response2[0];window.scrollTo(0,0);var html='';var view=getPageData().view;$('.listTopPaging',page).html(LibraryBrowser.getQueryPagingHtml({startIndex:query.StartIndex,limit:query.Limit,totalRecordCount:result.TotalRecordCount,viewButton:false,showLimit:false,updatePageSizeSetting:false,addLayoutButton:true,currentLayout:view})).trigger('create');updateFilterControls(page);var trigger=false;if(result.TotalRecordCount){var context=getParameterByName('context');if(view=="List"){html=LibraryBrowser.getListViewHtml({items:result.Items,context:context,sortBy:query.SortBy});trigger=true;}
else if(view=="Poster"){html=LibraryBrowser.getPosterViewHtml({items:result.Items,shape:"auto",context:context,showTitle:true,centerText:true,lazy:true});}
else if(view=="PosterCard"){html=LibraryBrowser.getPosterViewHtml({items:result.Items,shape:"auto",context:context,showTitle:true,cardLayout:true,lazy:true,showItemCounts:true});}
else if(view=="Thumb"){html=LibraryBrowser.getPosterViewHtml({items:result.Items,shape:"backdrop",context:context,showTitle:true,centerText:true,lazy:true,preferThumb:true});}
else if(view=="ThumbCard"){html=LibraryBrowser.getPosterViewHtml({items:result.Items,shape:"backdrop",context:context,showTitle:true,lazy:true,preferThumb:true,cardLayout:true,showItemCounts:true});}
$('.noItemsMessage',page).hide();}else{$('.noItemsMessage',page).show();}
var elem=page.querySelector('.itemsContainer');elem.innerHTML=html;ImageLoader.lazyChildren(elem);if(trigger){$(elem).trigger('create');}
$('.btnNextPage',page).on('click',function(){query.StartIndex+=query.Limit;reloadItems(page);});$('.btnPreviousPage',page).on('click',function(){query.StartIndex-=query.Limit;reloadItems(page);});$('.btnChangeLayout',page).on('layoutchange',function(e,layout){getPageData().view=layout;reloadItems(page);});LibraryBrowser.saveQueryValues(getSavedQueryKey(),query);Dashboard.hideLoadingMsg();});}
function updateFilterControls(tabContent){}
function initPage(tabContent){$('select.selectView').on('change',function(){var newView=this.value;getPageData().view=newView;reloadItems(tabContent);LibraryBrowser.saveViewSetting(getSavedQueryKey(),newView);});}
$(document).on('pageinitdepends',"#moviesPage",function(){var page=this;var index=3;$(page.querySelector('neon-animated-pages')).on('tabchange',function(){if(parseInt(this.selected)==index){var tabContent=page.querySelector('.pageTabContent[data-index=\''+index+'\']');if(!tabContent.initComplete){initPage(tabContent);tabContent.initComplete=true;}
if(LibraryBrowser.needsRefresh(tabContent)){reloadItems(tabContent);}}});});$(document).on('pageinitdepends',"#boxsetsPage",function(){var page=this;var content=page;initPage(content);}).on('pagebeforeshowready',"#boxsetsPage",function(){var page=this;var content=page;reloadItems(content);updateFilterControls(content);});})(jQuery,document);